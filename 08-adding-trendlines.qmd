---
title: "Adding a trend line"
format: 
  revealjs:
    code-fold: false
    theme: simple
    footer: "GEO4251 Climate Change & Storms"
    chalkboard: true
editor: source
---

##

Returning to the rain data from Northwest Florida 

-   Convert the June rain values to have units of centimeters
-   Make a time series plot showing the values over the years
-   Include a trend line

```{r}
#| echo: true
#| output-location: slide
Rain.df <- readr::read_table(here::here("data", "NWFL_MonthlyRain.txt")) |>
  dplyr::select(Year, Rain_in = Jun) |>
  dplyr::mutate(Rain_cm = Rain_in * 2.54)

library(ggplot2)

ggplot(data = Rain.df,
       mapping = aes(x = Year, y = Rain_cm)) +
  geom_line() + scale_x_continuous(breaks = seq(1900, 2020, 20)) +
  geom_smooth(method = lm, se = FALSE) +
  ylab("Rain (cm)")
```
##

-   The slope of the blue line is the average magnitude of change over the years
-   You quantify this change using the following code

```{r}
#| echo: true
lm(Rain_cm ~ Year, data = Rain.df)
```
-   The value below `Year` is the increase in the amount of rain in centimeters per year
-   This value of .023 cm per year amounts to 2.3 cm per 100 years

## A key climate indicator

-   Temperature is a key climate indicator. Temperature measurements made on land and in water across the globe tell us how temperature has changed over years, decades and centuries. They also tell us how temperature varies from one place to another

-   Global temperature is an aggregate over all the local temperature changes. It is a summary of the overall tendency in surface temperature and it is probably the longest instrumental series of global climate change that we have

-   Global temperatures from various research labs <https://climate.metoffice.cloud/temperature.html#datasets>

-   Annual global mean temperatures expressed as a difference from pre-industrial conditions (anomalies). Four data sets are available and there is good agreement between them

-   Anomalies are calculated relative to a 1981 to 2010 baseline and offset by 0.69°C, which is the best estimate difference for that period from the 1850-1900 average given in the IPCC sixth assessment report

## 

Global mean temperature

```{r}
#| echo: true
L <- "https://climate.metoffice.cloud/formatted_data/gmt_HadCRUT5.csv"
download.file(url = L,
              destfile = here::here("data", "T.csv"))

T.df <- readr::read_csv(here::here("data", "T.csv"),
                        show_col_types = FALSE)
names(T.df) <- c("Year", "T_C", "u")

T.df |>
  head()
```

##

Create a time series graph and add a ribbon indicating the uncertainty around the estimated values

```{r}
#| echo: true
ggplot(data = T.df,
       mapping = aes(x = Year, y = T_C, ymin = T_C-u, ymax = T_C+u)) +
  geom_ribbon(fill = "gray") + 
  geom_line() +
  scale_x_continuous(breaks = seq(1860, 2020, 20)) +
  ylab("°C")
```

##

## 

Global humidity

<https://climate.metoffice.cloud/humidity.html#datasets>

Specific humidity (q in g/kg)
```{r}
#| echo: true
L <- "https://climate.metoffice.cloud/formatted_data/humidity_q_HadISDH%20blend%20q.csv"
download.file(url = L,
              destfile = here::here("data", "q.csv"))

q.df <- readr::read_csv(here::here("data", "q.csv"))

q.df |>
  head()
```

##

Relative humidity

```{r}
#| echo: TRUE
download.file(url = "https://climate.metoffice.cloud/formatted_data/humidity_RH_HadISDH%20blend%20RH.csv",
              destfile = here::here("data", "RH.csv"))

RH.df <- readr::read_csv(here::here("data", "RH.csv"))

RH.df |>
  head()
```

##

Dew point temperature

```{r}
#| echo: TRUE
download.file(url = "https://climate.metoffice.cloud/formatted_data/humidity_Td_HadISDH%20blend%20Td.csv",
              destfile = here::here("data", "Td.csv"))

Td.df <- readr::read_csv(here::here("data", "Td.csv"))

Td.df |>
  head()
```

