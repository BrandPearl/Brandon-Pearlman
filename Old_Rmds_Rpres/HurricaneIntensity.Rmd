Hurricane Intensity
====================

We determined last time that hurricanes are not occurring more often. But what about intensity? Are they getting stronger?

Here we use a dataset showing the lifetime highest intensity for each tropical cyclone in the Atlantic since 1966. 

As we did before we get the dataset into R using two lines of code (code chunk). 
```{r}
L = 'http://myweb.fsu.edu/jelsner/data/LMI.txt'
df = read.table(L, header = TRUE)
```

Recall L locates the data (LMI.txt) on a server. The data is read into R using the read.table function. The first argument to the read.table function is L. The result is a data frame called df.

To see what the data look like click on df in the Environment window. Data frames have rows and columns. Here the rows are the individual hurricanes in chronological order and the columns are different variables.

The variable of interest is WmaxS. A hurricane is born, it grows in strength, then dissipates often over land. At one point it's at peak strength. This is it's lifetime maximum given in the column labeled WmaxS.

The variable WmaxS has units of knots. We first convert it to units of meters per second by multiplying it by a constant.
```{r}
df$WmaxS = df$WmaxS * .5144
```

Next we make a box plot showing the lifetime fastest wind speeds each year.
```{r}
library("ggplot2")
ggplot(df, aes(x = factor(Yr), y = WmaxS)) +
         geom_boxplot()
```

The plot shows the distribution of winds for all the storms in a given year. The median intensity is shown with a black hash mark inside the box. The top and bottom of the box define the upper and lower quartiles of the distribution.

It appears as if the strongest cyclones are getting stronger as the top of the boxes tend to be higher up the vertical axis later in the period. 

To examine this in more detail we determine 90th percentile (upper decile) of the distribution.
```{r}
quantile(df$WmaxS, .9)
```

We find that 90% of the cyclones have winds that peak below 60 m/s. Or 10% have winds that are 60 m/s (category 4) or stronger.

Next we draw a trend line through the 90th percentile each year. First group by year and find the 90th percentile then use ggplot as before.

Here do all the operations together using the %>% operator. This is read as "then". Don't worry if you don't understand the details at this time. Just run the code.
```{r}
library("dplyr")
df %>%
  group_by(Yr) %>%
  summarize(q90 = quantile(WmaxS, .9)) %>%
   ggplot(., aes(x = Yr, y = q90)) +
    geom_point() +
    geom_smooth(method = lm) +
    ylab("90th Percentile Wind Speed (m/s)")
```

A significant upward trend.

What would you change in the code chunk above to examine the 95th percentile winds? Try it. What do you find?
